<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="ReDAO">
	
	
	
	<!-- 댓글 등록  -->
	<insert id="insertRe" parameterType="re">
		<selectKey keyProperty="reId" resultType="int" order="BEFORE">
			select
			NVL(max(re_id),0) +1 from re
			

		</selectKey>
		insert into re(	re_id
						,search_id
						,user_id
		        		,contents
		)
		
		values( 	 #{reId}
					,#{searchId}
					,#{userId}
					,#{contents}
		)

	</insert>
	
	
	<!-- paging 리스트 -->
	<select id="repageList" resultType="int">
		select count(*) from re
	</select>
	
	
	
<!-- 	전체조회 -->
 	
	<select id ="reList" resultType="re">
	select * from re order
	by re_id desc
	</select>

<!-- 전체조회2 -->

	<select id="reMap" resultType="map">
	
	SELECT b.* FROM ( SELECT rownum no, a.* FROM (
	select re_id as "reId",
			user_id as "userId",
			contents as "contents",
			to_char(write_date, 'YY/MM/DD') as "writeDate" 
	from re

	where search_id = #{searchId}
	
	<choose>
		<when test="orderby != null and orderby != ''">
			order by #{orderby} desc
		</when>
		<otherwise>
			order by re_id desc
		</otherwise>
	</choose>
	) a ) b WHERE no BETWEEN #{first} AND #{last}
	</select>
		

</mapper>